# 二、理解 CGDB 的几个核心概念

上一章：打开和关闭 CGDB，下一节：理解代码窗口，目录：目录

* * *

# 2 理解 CGDB 的几个核心概念

CGDB 的界面默认由两个窗口和一条状态栏组成。代码窗口默认在上方，GDB 窗口默认在下方。状态栏在两个窗口之间。

根据不同窗口的激活情况，CGDB 有不同的模式。当代码窗口被激活时，CGDB 处于 CGDB 模式。当 GDB 窗口被激活时，CGDB 处于 GDB 模式。当 TTY 窗口被激活时，CGDB 处于 TTY 模式。

当 CGDB 发布 1.0 的版本时，所有的窗口将会是可移动的，用户可以创建想要的窗口，个数不限。但是目前我的时间都花在了开发 CGDB 和 GDB 之间的接口上。当这部分完成的时候，CGDB 的界面会变得更完美。如果你是一个熟悉 ncurses 的开发者，并且有业余时间来做这部分工作的话，请联系我。

# 2.1 理解代码窗口

上一节：理解 CGDB 的几个核心概念，下一节：理解 GDB 窗口，目录：目录

* * *

## 2.1 理解代码窗口

您可以通过代码窗口查看当前被调试程序的源代码。CGDB 只能同时显示一个源文件。当用户调试程序的时候，通过 *next* 和 *step* 命令，CGDB 将会更新源代码以及行号，以此提醒您调试进行到了何处。

CGDB 有几个新特性能让调试比使用旧的 GDB 更方便。其中，当您在调试 C，C++或 ADA 程序的时候，源代码是高亮的。这个特性可以让您更加快速的找到源文件中的特定代码。如果您需要让 CGDB 在调试其他语言程序的时候能够显示代码高亮，请联系我们。一些代码窗口的使用命令参见 3.1 节。

除了显示源代码，CGDB 也显示当前运行的代码行。当前被 GDB 运行的代码行的行号被高亮成绿色，同时 CGDB 也在这一行的行号前显示一个箭头。您可以通过配置选项 *':set arrowstyle'* 来配置箭头的样式。默认的情况下，使用值 *short* 配置的短箭头生效。但是我个人更加喜欢使用值 *long* 配置的长箭头。

当您浏览代码窗口时，光标所在行的行号被高亮成了白色。它使得您可以知道光标处在当前文件的什么位置。

您可以通过 CGDB 的代码窗口设置或者取消一个断点。浏览至您需要设置断点的行，然后按下空格键，断点就会被设置。当断点成功被设置时，行号会被标红。再按下一次空格键断点就会被取消。当断点被禁用的时候，行号会被标黄。

CGDB 还支持在代码窗口中使用正则表达式搜索源代码。您可以按下 */* 或者 *?*，然后加上您要搜索的字符串或者是正则表达式。这里的搜索使用的是 C 语言的正则表达式库，使得在搜索 *'\*' *或* '+'* 时表现的更快。

代码窗口中可使用的全部命令的列表在 3.1 节。

# 2.2 理解 GDB 窗口

上一节：理解代码窗口，下一节：理解文件对话框窗口，目录：目录

* * *

## 2.2 理解 GDB 窗口

CGDB 通过 GDB 窗口让用户直接操作 gdb。如果您想要将一个命令发送给 gdb，只要将命令输入进 GDB 窗口即可。使用 CGDB 中的 GDB 窗口和在命令行下使用 gdb 是完全一样的。

在这个窗口中输入的一部分快捷键会被 CGDB 截获并处理，而非直接发送给 gdb。这些快捷键的列表在 3.2 节

类似于终端操作，CGDB 将会将您连续输入的多个命令缓存起来。因此当您在一个命令完成之前又输入了多个其他的命令，这些命令会被 CGDB 按照顺序依次执行。就像在 gdb 中调试一样，除非按下 *Ctrl-C* ，否则缓存的命令不会被停止执行。

# 2.3 理解文件对话框窗口

上一节：理解 GDB 窗口，下一节：理解 TTY 窗口，目录：目录

* * *

## 2.3 理解文件对话框窗口

通过文件对话框窗口，用户可以浏览和选择他们想要查看的文件。它为用户提供了一个与被调试程序有关的所有源代码文件的列表。如果没有文件被显示，可能是因为没有程序正在被调试，或者是因为被调试的可执行程序中没有调试信息，在这些情况下，文件对话框窗口不会打开，状态栏上会显示一条错误信息。

您可以通过在代码窗口中键入 *o* 来打开文件对话框窗口。当您打开了文件对话框窗口后，需要通过键入 *q* 来关闭它。您可以通过方向键来选择您想要的文件，甚至可以使用正则表达式去搜索文件。在文件数量越来越多的情况下，这个功能可以省去您很多的时间。

文件对话框窗口中可使用的全部命令的列表在 3.3 节。

# 2.4 理解 TTY 窗口

上一节：理解文件对话框窗口，下一节：理解状态栏，目录：目录

* * *

## 2.4 理解 TTY 窗口

用户可以通过 TTY 窗口将程序的输入传给被调试的程序。这个窗口与 GDB 窗口类似，除了在 TTY 窗口中输入的数据将被直接传给被调试的程序。参见第七章。

您会看到，在 TTY 窗口和被调试的程序窗口之间有一个 tty 设备。因此如果被调试的程序使用 readline 等行缓冲输入，则命令行输入是可以被编辑的。这个 tty 设备也会被通过 TTY 窗口当作程序的终端输出。您可以在 TTY 窗口和 GDB 窗口之间看到这个 tty 设备的名字。

TTY 窗口中可使用的全部命令的列表在 3.4 节。

对被调试的程序进行的 I/O 容易让人迷惑。这部分在第七章有更好的解释。除非被调试的程序的 I/O 比较简单，否则我通常都会选择在另外一个终端启动被调试程序，然后在 CGDB 中连接上被调试程序。

# 2.5 理解状态栏

上一节：理解 TTY 窗口，下一节：在不同的窗口中切换，目录：目录

* * *

## 2.5 理解状态栏

状态栏是 CGDB 向用户显示正在输入的命令和当错误发生时报告错误的最通用的方式。CGDB 不使用弹窗和其它形式的输出来告知用户信息或有错误发生。

当 CGDB 运行的时候，您可以通过任何在 CGDB 配置文件中有效的配置命令去配置 CGDB。只需要代码窗口键入 *:* 您就可以看见一个冒号出现在状态栏中，此后输入的命令也会被显示在状态栏中。当您输入了您想要执行的命令后，键入 *enter* 。这将会让 CGDB 运行您之前键入的命令。如果您在输入命令的时候想要取消您输入的内容，可以按下 CGDB 的模式选择键。这样做会让您回到 CGDB 模式。更详细的关于 CGDB 的模式选择键参见 2.6 节。

状态栏中可使用的全部命令的列表在第四章。

# 2.6 在不同的窗口中切换

上一节：理解状态栏，下一章：CGDB 命令，目录：目录

* * *

## 2.6 在不同的窗口中切换

当 CGDB 最初运行时，CGDB 默认处于 GDB 模式。状态栏右侧的 *** 符号显示当前的输入会被传入 GDB 窗口。按下* ESC *键可切换至代码窗口，CGDB 模式切换键是将用户从别的模式切换到 CGDB 模式的快捷键，默认的 CGDB 模式切换键是* ESC* 。如果您想改变 CGDB 模式切换键对应的快捷键，请查阅 CGDB 的配置选项。参见第四章。

现在 CGDB 处于 CGDB 模式。要切换回 GDB 模式，键入 *i* 。这个设置是基于最流行的 Unix 文本编辑器：vi。